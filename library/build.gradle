plugins {
    id "org.jetbrains.kotlin.android" version "$kotlinVersion"
    id 'com.vanniktech.maven.publish'
}

apply plugin: "com.android.library"
apply plugin: 'com.vanniktech.maven.publish'

ext {
    group 'com.github.tommyettinger'
    publishedGroupId = 'com.github.tommyettinger'
    libraryName = 'libGDX Oboe'
    artifact = 'libgdxoboe'

    libraryDescription = 'libGDX audio replacement for Android (API 16+) built on top of Oboe.'

    siteUrl = 'https://github.com/barsoosayque/libgdx-oboe'
    gitUrl = 'https://github.com/barsoosayque/libgdx-oboe.git'

    libraryVersion = "$VERSION_NAME"
    version = libraryVersion

    developerId = 'barsoosayque'
    developerName = 'barsoosayque'
    developerEmail = 'shtoshich@gmail.com'

    licenseName = 'The MIT License'
    licenseUrl = 'https://opensource.org/licenses/MIT'
    allLicenses = ["MIT"]
}

// Disable JDK 8's doclint
// http://blog.joda.org/2014/02/turning-off-doclint-in-jdk-8-javadoc.html
if (JavaVersion.current().isJava8Compatible()) {
    allprojects {
        tasks.withType(Javadoc) {
            // The -quiet is because of some sort of weird JDK JavaCompiler bug:
            // https://discuss.gradle.org/t/passing-arguments-to-compiler-and-javadoc/1661
            options.addStringOption('Xdoclint:none,-missing', '-quiet')
            options.tags('apiNote:a:"API Note"', 'implSpec:a:"Implementation Requirements"', 'implNote:a:"Implementation Note"')
        }
    }
}

if(JavaVersion.current().isJava9Compatible()) {
    allprojects {
        tasks.withType(JavaCompile) {
            options.release.set(8)
        }
    }
}

configurations { natives }
sourceCompatibility = 1.6

dependencies {
    implementation "com.badlogicgames.gdx:gdx-backend-android:$gdxVersion"
    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlinVersion"
}

android {
    buildToolsVersion androidBuildToolsVersion
    compileSdkVersion androidSdkVersion
    ndkVersion androidNdkVersion
    sourceSets.main {
        manifest.srcFile 'AndroidManifest.xml'
        java.srcDirs = ['src/kotlin']
    }
    defaultConfig {
        minSdkVersion 16
        targetSdkVersion androidSdkVersion
        ndk { abiFilters 'x86', 'x86_64', 'armeabi-v7a', 'arm64-v8a' }
        externalNativeBuild {
            cmake {
                cppFlags "-std=c++17 -O3 -DCMAKE_BUILD_TYPE=Release -DNDEBUG"
            }
        }
        consumerProguardFiles 'proguard-rules.pro'
    }
    externalNativeBuild {
        cmake {
            path "CMakeLists.txt"
        }
    }
}
